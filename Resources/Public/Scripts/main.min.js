function formatDate(format,date){var escaped=[],weekdayShort=["So","Mo","Di","Mi","Do","Fr","Sa"],weekdayLong=["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"];return format=format.replace(/D/g,function(){return"{"+weekdayShort[date.getDay()]+"}"}),format=format.replace(/l/g,function(){return"{"+weekdayLong[date.getDay()]+"}"}),format=format.replace(/\{(.+?)\}/g,function(match,$1){return escaped.push($1),"{}"}),format=format.replace(/d/g,function(){return d=date.getDate(),d<10?"0"+d:d}),format=format.replace(/j/g,function(){return date.getDate()}),format=format.replace(/m/g,function(){return m=date.getMonth()+1,d<10?"0"+m:m}),format=format.replace(/n/g,function(){return date.getMonth()+1}),format=format.replace(/Y/g,function(){return date.getFullYear()}),format=format.replace(/y/g,function(){return(date.getFullYear()+"").slice(2)}),format=format.replace(/G/g,function(){return date.getHours()}),format=format.replace(/H/g,function(){return H=date.getHours(),H<10?"0"+H:H}),format=format.replace(/i/g,function(){return i=date.getMinutes(),i<10?"0"+i:i}),format=format.replace(/\{\}/g,function(){return escaped.shift()})}function hashStr(str){var i,hash=0;if(0===str.length)return hash;for(i=0;i<str.length;i++)hash=(hash<<5)-hash+str.charCodeAt(i),hash|=0;return hash}function buildFromToString(datum,von,bis){var datestring="";if(datum.match(/^(0?[1-9]|[12][0-9]|3[01])\.(0?[1-9]|1[012])\.\d{4}$/)&&von.match(/^(0?[0-9]|1[0-9]|2[0-4]):(0?[0-9]|[1-5][0-9])(:(0?[0-9]|[1-5][0-9]))?$/)){if("string"==typeof bis&&bis.length>0){if(!bis.match(/^(0?[0-9]|1[0-9]|2[0-4]):(0?[0-9]|[1-5][0-9])(:(0?[0-9]|[1-5][0-9]))?$/))return}else bis=null;return datum=datum.split("."),von=von.split(":"),von=new Date(datum[2],datum[1]-1,datum[0],von[0],von[1],von[2]||0,0),bis&&(bis=bis.split(":"),bis=new Date(datum[2],datum[1]-1,datum[0],bis[0],bis[1],bis[2]||0,0)),datestring+=formatDate("D., j.n.Y ",von),bis?(datestring+=formatDate("{von} H:i ",von),datestring+=formatDate("{bis} H:i {Uhr}",bis)):datestring+=formatDate("{um} H:i {Uhr}",von),datestring}}function displayTrainingEvents(container,xml,options){options=options||{};var table=$("<table>");$(xml).find("lehrgang").each(function(index){if("number"==typeof options.maxEvents&&options.maxEvents>0&&index>=options.maxEvents)return!1;var lehrgang=$(this),tr=$("<tr>"),lehrgangstyp=lehrgang.find("lehrgangstyp bezeichnung").text(),ausbildungsort=lehrgang.find("ausbildungsort"),ort=ausbildungsort.find("plz").text()+" "+ausbildungsort.find("ort").text(),adresse=ausbildungsort.find("adresse").text(),gebuehr=lehrgang.find("tn_gebuehr").text(),plaetze=lehrgang.find("freie_plaetze").text();plaetze=parseInt(plaetze),plaetze=!isNaN(plaetze)&&plaetze>0?plaetze:0,options.bezeichnung&&$("<td>").addClass("bezeichnung").text(lehrgangstyp).appendTo(tr);var details=[],termine=lehrgang.find("termine termin");termine.each(function(){var termin=$(this),datum=termin.find("datum").text(),von=termin.find("uhrzeit_von").text(),bis=termin.find("uhrzeit_bis").text();details.push('<span class="fromTo">'+buildFromToString(datum,von,bis)+"</span>")}),details.push('<span class="ort">'+ort+", "+adresse+"</span>"),0===plaetze?details.push('<span class="plaetze">Leider sind alle Plätze vergeben.</small>'):details.push('<span class="preis">Preis: <em>'+gebuehr+'€</em>,</span> <span class="plaetze">Freie Plätze: <em>'+plaetze+"</em></span>"),$("<td>").html(details.join("<br />")).appendTo(tr);var url=lehrgang.find("url_anmeldung").text();if(url){var link=$("<a>");link.text("Anmelden"),link.attr("href",url),link.attr("target","_blank"),$("<td>").append(link).appendTo(tr)}else $("<td>").appendTo(tr);tr.attr("data-plaetze",plaetze),tr.appendTo(table)}),container.empty(),table.find("tr").length>0?container.append(table):container.append("<p>(Keine Kurstermine gefunden)</p>")}function loadTrainingEvents(){var dom=$(this),options={bezeichnung:dom.data("bezeichnung")||!1,maxEvents:dom.data("maxevents")||0,url:dom.data("url")},params={Lic:dom.data("lic"),XML:"J",LgTyp:dom.data("lgtyp")||"0",Mon:"number"==typeof dom.data("mon")&&dom.data("mon")>=0?dom.data("mon"):"",Ort:"string"==typeof dom.data("location")?dom.data("location"):""};options.url&&(dom.html('<p><div class="spinner"><div class="loader"/></div> (Lade Kurstermine)</p>'),options.url+="?"+$.param(params),$.ajax({url:options.url,method:"GET",dataType:"xml",success:function(xml){displayTrainingEvents(dom,xml,options)},error:function(){console.log("error",arguments),dom.html("<p>(Termine konnten nicht geladen werden)</p>")}}))}function displayHiorgEvents(container,html,options){options=options||{};var globalCategories={},i=0,table=$("<table>");if(html.find("tbody tr").each(function(){var eventRow=$(this),tr=$("<tr>"),details=[];if(i>=options.limit&&options.limit>0)return!1;var dayString=eventRow.find("td:eq(0)").text().trim().replace(/\s\s+/g," ");dayString=dayString.replace(/.*(\d{2}\.\d{1,2}\.\d{2,4}).*/,"$1");var timeString=eventRow.find("td:eq(1)").text().trim().replace(/\s\s+/g," ");timeStringSplit=timeString.split("-");var fromToString=buildFromToString(dayString,$.trim(timeStringSplit[0]),$.trim(timeStringSplit[1])),locationString=eventRow.find("td:eq(2)").text().trim().replace(/\s\s+/g," "),title=eventRow.find("td:eq(3)"),categories=(eventRow.find("td:eq(4) a").attr("href"),title.find(".katlabel").map(function(){return $(this).text().trim().replace(/\s\s+/g," ")}).toArray()),categoryNumber=title.find(".katlabel").map(function(){return $(this).attr("class").replace(/(.*col([0-9]{1,3}))?.*/,"$2")}).toArray(),categoryClasses=$.map(categories,function(category){return category.replace(/ /g,"-").toLowerCase()}),titleString=title.find(".katlabel").remove().end().text().trim().replace(/\s\s+/g," ");if(locationString.match(options.locationRegex)&&titleString.match(options.titleRegex)){var categoryFilter=function(val){return val.match(options.categoryRegex)};categories.length>0&&0===categories.filter(categoryFilter).length||".*"!==options.category&&0===categories.length||(details.push('<div class="title">'+titleString+"</div>"),details.push('<div class="fromTo">'+fromToString+"</div>"),details.push('<div class="location"><span class="fa fa-map-marker"></span> '+locationString+"</div>"),$("<td>").html(details.join("")).appendTo(tr),tr.addClass(categoryClasses.join(" ")),$.each(categories,function(index,category){var hash=hashStr(category),hue=Math.abs(hash)%360,saturation=90,lightness=55,span=$("<span>");span.addClass(categoryClasses[index]),span.addClass("category"),span.css({"background-color":"hsl("+hue+", "+saturation+"%, "+lightness+"%)",color:"#fff"}),span.attr("title",category),categoryNumber&&categoryNumber[index]&&span.addClass("cat"+categoryNumber[index]),tr.find(".title").prepend(span),globalCategories[categoryClasses[index]]||(globalCategories[categoryClasses[index]]={name:category,number:categoryNumber[index],cat:"cat"+categoryNumber[index]})}),table.append(tr),i++)}}),container.empty(),table.find("tr").length>0){if(container.append(table),Object&&Object.keys&&Object.keys(globalCategories).length>1){var keys=$("<div>");keys.addClass("keys");var p=$("<p>");keys.append(p),$.each(globalCategories,function(className,category){var cat=$("<span>");cat.addClass(category.cat),cat.addClass(className),cat.addClass("category"),cat.attr("title",category.name);var key=$("<span>");key.addClass("key"),key.append(cat),key.append(document.createTextNode(category.name)),p.append(key)}),container.append(keys)}}else container.append("<p>(Keine Termine gefunden)</p>")}function loadHiorgEvents(){var dom=$(this),options={limit:dom.data("limit")||0,title:dom.data("title")||".*",location:dom.data("location")||".*",category:dom.data("category")||".*",ov:dom.data("ov")||"",url:dom.data("url")};if(options.locationRegex=new RegExp(options.location,"i"),options.titleRegex=new RegExp(options.title,"i"),options.categoryRegex=new RegExp(options.category,"i"),"string"==typeof options.ov&&0!==options.ov.length&&"string"==typeof options.url&&0!==options.url.length){options.url+="?"+$.param({ov:options.ov}),dom.html('<p><div class="spinner"><div class="loader"/></div> (Lade Termine)</p>');var cache="";try{cache=JSON.parse(localStorage.getItem(options.url))||""}catch(err){}return cache.time&&(new Date).getTime()-cache.time<36e5&&!$("body").hasClass("neos-backend")?void displayHiorgEvents(dom,$(cache.content),options):void $.ajax({url:options.url,method:"GET",dataType:"text",success:function(text){text=text.replace(/<img[^>]*src=[^>]*>/gi,""),localStorage.setItem(options.url,JSON.stringify({time:(new Date).getTime(),content:text})),displayHiorgEvents(dom,$(text),options)},error:function(){console.log("error",arguments),dom.html("<p>(Termine konnten nicht geladen werden)</p>")}})}}function displayBloodDonationEvents(container,html,options){options=options||{};var i=0,table=$("<table>");html.find("item").each(function(){var item=$(this),tr=$("<tr>"),details=[];if(i>=options.limit&&options.limit>0)return!1;var dayString=item.find("title").text().trim().replace(/\s\s+/g," ");dayString=dayString.replace(/.*(\d{2}\.\d{1,2}\.\d{2,4}).*/,"$1");var timeString=item.find("title").text().trim().replace(/\s\s+/g," ");timeStringSplit=timeString.replace(/.*((\d{2}:\d{2}) ?bis ?(\d{2}:\d{2})).*/,"$2-$3"),timeStringSplit=timeStringSplit.split("-");var fromToString=buildFromToString(dayString,$.trim(timeStringSplit[0]),$.trim(timeStringSplit[1])),locationString=item.find("title").text().trim().replace(/\s\s+/g," ");locationString=locationString.replace(/^([0-9]{5}.*?) am.+/i,"$1");var titleString="Blutspende: "+locationString.replace(/^[0-9]{5} /,"");locationString+=", "+item.find("description").text().trim().replace(/\s\s+/g," ");var detailUrl=item.find("guid").text().trim();if(detailUrl=detailUrl.replace(/ergebnisse\.php/,"detail.php"),detailUrl=detailUrl.replace(/donor_id=/,"id="),details.push('<div class="title">'+titleString+"</div>"),details.push('<div class="fromTo">'+fromToString+"</div>"),details.push('<div class="location"><span class="fa fa-map-marker"></span> '+locationString+"</div>"),$("<td>").html(details.join("")).appendTo(tr),detailUrl.match(/^https?:\/\/www.drk-blutspende.de/)){var link=$("<a>");link.text("Mehr"),link.attr("href",detailUrl),link.attr("target","_blank"),$("<td>").append(link).appendTo(tr)}table.append(tr),i++}),container.empty(),table.find("tr").length>0?container.append(table):container.append("<p>(Keine Termine gefunden)</p>")}function loadBloodDonationEvents(){var dom=$(this),options={limit:dom.data("limit")||0,location:dom.data("location")||null,url:dom.data("url")||null};if("string"==typeof options.location&&0!==options.location.length&&"string"==typeof options.url&&0!==options.url.length){options.url+="?"+$.param({location:options.location}),dom.html('<p><div class="spinner"><div class="loader"/></div> (Lade Termine)</p>');var cache="";try{cache=JSON.parse(localStorage.getItem(options.url))||""}catch(err){}return cache.time&&(new Date).getTime()-cache.time<36e5&&!$("body").hasClass("neos-backend")?void displayBloodDonationEvents(dom,$(cache.content),options):void $.ajax({url:options.url,method:"GET",dataType:"text",success:function(text){localStorage.setItem(options.url,JSON.stringify({time:(new Date).getTime(),content:text})),displayBloodDonationEvents(dom,$(text),options)},error:function(){console.log("error",arguments),dom.html("<p>(Termine konnten nicht geladen werden)</p>")}})}}function fitGallery(galleries){galleries.each(function(){var r,self=$(this),a=self.find("a"),n=a.length,w=self.innerWidth(),small=!1;for(i=1;i<=n;i++)if(r=i,Math.abs(w/i-100)<20){small=!0;break}a.attr("data-width",100/r-1),a.css("width",100/r-1+"%"),a.css("marginRight","1%");var remaining=small?a.slice(0,n%r):a;remaining.css("width",100/(n%r)-1+"%").addClass("square"),a.each(function(){var self=$(this);if((1===n||1===remaining.length&&self.hasClass("square"))&&"function"==typeof Image&&self.attr("data-bg-url-max")){self.css("backgroundImage","url("+self.attr("data-bg-url-max")+")");var image=new Image;image.onload=function(){var scale=image.width/image.height,height=self.width()/scale;self.css("height",height>self.width()?self.width():height)},image.src=self.attr("data-bg-url-max")}else self.hasClass("square")&&self.attr("data-bg-url-square")?(self.css("height",self.width()),self.css("backgroundImage","url("+self.attr("data-bg-url-square")+")")):self.width()>240&&self.attr("data-bg-url-large")?self.css("backgroundImage","url("+self.attr("data-bg-url-large")+")"):self.width()>120&&self.attr("data-bg-url-medium")&&self.css("backgroundImage","url("+self.attr("data-bg-url-medium")+")")});var VISIBLE_ROWS=3;if(Math.ceil(n/r)>=VISIBLE_ROWS){var last=n%r===0?VISIBLE_ROWS*r:n%r+(VISIBLE_ROWS-1)*r;if(last-=1,n-1>last){a.removeClass("lastImage hiddenImage");var more=$("<div>");more.addClass("more"),more.text("+"+(n-last-1)),more.click(function(ev){ev.preventDefault(),ev.stopPropagation(),a.removeClass("lastImage hiddenImage"),$(this).remove()}),self.find("a:eq("+last+")").addClass("lastImage").empty().append(more),self.find("a:gt("+last+")").addClass("hiddenImage")}}})}function formToObject(form){form=form||$("form").first();var obj={};return form.find(".form-group").each(function(){var group=$(this),label=group.find(".control-label")||group.find("label");if(label){label=label.first().text();var inputs={};group.find("input, textarea").each(function(){var input=$(this),name=input.attr("name"),value=input.val();name&&value&&(inputs[name]=value)}),obj[label]=inputs}}),obj}function typeNames(el,names,i,j){if(!(i>=names.length)){if(j>=names[i].length)return void(typeTimeout=setTimeout(function(){typeNames(el,names,i+1,0)},3e3));var n=el.text()||"";0===j&&(n=""),el.css("line-height",el.height()+"px"),typeTimeout=setTimeout(function(){if(el.text(n+names[i][j]),el.prop("scrollHeight")>el.height())for(var fontSize=parseInt(el.css("font-size"));fontSize>14&&el.prop("scrollHeight")>el.height();)el.css("font-size",--fontSize+"px");typeNames(el,names,i,j+1)},800*Math.random())}}$(".events").each(function(){switch($(this).data("type")){case"hiorg":loadHiorgEvents.call(this);break;case"bloodDonation":loadBloodDonationEvents.call(this);break;case"training":default:loadTrainingEvents.call(this)}}),$("body").hasClass("neos-backend")?$('a[href$=".jpg"]:has(img)').each(function(){$(this).attr("href","#")}):$("article, .operation").each(function(){var self=$(this),images=self.find(".images a").add(self.find('a[href$=".jpg"]:has(img)'));images.magnificPopup({tClose:"Schließen (ESC)",tLoading:"Lade Foto...",type:"image",gallery:{enabled:!0,tPrev:"Vorheriges (Linke Pfeiltaste)",tNext:"Nächstes (Rechte Pfeiltaste)",tCounter:'<span class="mfp-counter">%curr%. von %total% Fotos in diesem Beitrag</span>'},image:{tError:'<a href="%url%">Das Foto</a> konnte nicht geladen werden.'},callbacks:{imageLoadComplete:function(){var src=this.currItem.src;Piwik&&Piwik.getTracker().trackLink(src,"download")}}})});var prevW=$(window).width();fitGallery($(".gallery")),$(window).resize(function(){prevW!==$(window).width()&&(fitGallery($(".gallery")),prevW=$(window).width())}),$(".paypal").each(function(){var self=$(this);self.find('input[type="range"]').rangeslider({polyfill:!1,onSlide:function(pos,val){var slider=this;$(slider.$fill);if(val>50){var minp=50,maxp=100,minv=Math.log(70),maxv=Math.log(1e3),scale=(maxv-minv)/(maxp-minp);val=Math.exp(minv+scale*(val-minp)),val=10*Math.round(val/10),val=Math.floor(val)}self.find('[name="amount"]').val(val)}}),$('[name="amount"]').keyup(function(){var number=this.value.replace(/[^0-9]/g,"");this.value!==number&&(this.value=number)})});var _paq=_paq||[];$(function(){if(0!==$("#trackingCode").length){var currentUser=window.location.pathname.replace(/.+@user-([a-z]+)\.html/i,"$1");currentUser=currentUser!==window.location.pathname?currentUser:null,"string"==typeof drkException&&"notFoundExceptions"===drkException&&_paq.push(["setDocumentTitle","404/URL = "+encodeURIComponent(document.location.pathname+document.location.search)+"/From = "+encodeURIComponent(document.referrer)]),_paq.push(["removeDownloadExtensions","jpeg|jpg"]),_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]);var u=$("#trackingCode").attr("data-host");u="//"+u+"/",_paq.push(["setTrackerUrl",u+"piwik.php"]),_paq.push(["setSiteId",$("#trackingCode").attr("data-siteId")]);var d=document,g=d.createElement("script"),s=d.getElementsByTagName("script")[0];g.type="text/javascript",g.async=!0,g.defer=!0,g.src=u+"piwik.js",s.parentNode.insertBefore(g,s)}}),$("#socialmedia").socialSharePrivacy({css_path:"",lang_path:"/_Resources/Static/Packages/DRKTettnang.Homepage/Vendor/socialshareprivacy/lang/",language:"de",services:{facebook:{perma_option:"off",dummy_img:"/_Resources/Static/Packages/DRKTettnang.Homepage/Vendor/socialshareprivacy/images/dummy_facebook_share_de.png"},twitter:{status:"on",perma_option:"off",dummy_img:"/_Resources/Static/Packages/DRKTettnang.Homepage/Vendor/socialshareprivacy/images/dummy_twitter.png"},gplus:{perma_option:"off",dummy_img:"/_Resources/Static/Packages/DRKTettnang.Homepage/Vendor/socialshareprivacy/images/dummy_gplus.png"}}}),window.___gcfg={lang:"de"},$("#main-sidebar>*").width($("#main-sidebar").width()+"px"),$(window).resize(function(){$("#main-sidebar>*").width($("#main-sidebar").width()+"px")}),$("#main-content").height()>$("#main-sidebar").height()&&$("#main-sidebar > .inner").affix({offset:{top:$("#main-sidebar > .inner").offset().top,bottom:$("footer").outerHeight(!0)+30}}),$('[data-toggle="tooltip"]').not("input").tooltip(),$('input[data-toggle="tooltip"]').tooltip({placement:"bottom",trigger:"focus"}),$("[data-edon][data-niamod]").each(function(){var href="mailto:";href+=$(this).attr("data-edon"),href+="@",href+=$(this).attr("data-niamod"),$(this).attr("href",href)}),$(".cache input").each(function(){var input=$(this),key=window.location.pathname+"#"+input.attr("name"),saved=localStorage.getItem(key);saved&&input.val(saved)}),$(".cache input").change(function(){var input=$(this),key=window.location.pathname+"#"+input.attr("name");localStorage.setItem(key,input.val())}),$("form input").on("invalid",function(){var el=$(this),name=el.attr("name")||el.attr("id");Piwik&&name&&Piwik.getTracker().trackEvent("Form","invalid",name)}),$("form").on("reset",function(){var form=$(this);setTimeout(function(){form.find("input").change()},500)}),$(".printOnClick").click(function(){window.print()}),$("button.reset").length&&$('button[type="reset"]').length&&($("button.reset").show(),$('button[type="reset"]').hide(),$("button.reset").click(function(){return $("body").click(function(){$("button.reset").show(),$('button[type="reset"]').hide()}),$(this).button("reset"),setTimeout(function(){$("button.reset").hide(),$('button[type="reset"]').show()},200),!1}),$('button[type="reset"]').removeClass("btn-default").addClass("btn-danger").each(function(){$(this).text($(this).attr("data-value"))})),$(".time").clockpicker({donetext:"Fertig",minutestep:5,autoclose:!0}),$(".date input").datepicker({format:"dd.mm.yyyy",weekStart:1,startDate:"today",language:"de",calendarWeeks:!0,autoclose:!0,todayHighlight:!0}),$(".icon-next").each(function(){$(this).removeClass("icon-next").addClass("glyphicon glyphicon-chevron-right")}),$(".icon-prev").each(function(){$(this).removeClass("icon-prev").addClass("glyphicon glyphicon-chevron-left")});var typeTimeout;"transform"in $("body")[0].style&&!function(){var container=$('[alt$="animated"]').parent();if(container.addClass("your-name-container"),0!==container.length){var yourName=$("<div>");yourName.addClass("your-name"),yourName.appendTo(container),yourName.css("line-height",yourName.height()+"px"),yourName.click(function(ev){ev.stopPropagation(),clearTimeout(typeTimeout),Piwik&&Piwik.getTracker().trackEvent("Participate","change");var name=prompt("Wie ist dein Name?");return localStorage.setItem("name",name||""),name&&typeNames(yourName,[name],0,0),!1});var names=["Ursula","Peter","Dein Name?"];localStorage&&localStorage.getItem("name")&&"string"==typeof localStorage.getItem("name")&&(names=[localStorage.getItem("name")]),typeNames(yourName,names,0,0)}}();
//# sourceMappingURL=main.min.js.map